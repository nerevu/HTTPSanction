{
  "$schema": "../schemas/provider.schema.json",
  "prefix": "mailgun",
  "auths": [
    {
      "authId": "base",
      "authType": "basic",
      "documentationURL": "https://documentation.mailgun.com/en/latest/api_reference.html",
      "username": "api",
      "password": "$MAILGUN_API_KEY",
      "dataKey": "data",
      "attrs": {
        "domain": "$MAILGUN_DOMAIN"
      }
    },
    {
      "authId": "server",
      "parent": "base",
      "apiBaseURL": "https://api.mailgun.net/v3/{domain}"
    },
    {
      "authId": "account",
      "parent": "base",
      "isDefault": true,
      "apiBaseURL": "https://api.mailgun.net/v3"
    }
  ],
  "statusResourceId": "domains",
  "resources": [
    {
      "resourceId": "domains",
      "authId": "account",
      "resultKey": "0.items"
    },
    {
      "resourceId": "emailLists",
      "resourcePath": "lists/{listPrefix}@{domain}",
      "authId": "account",
      "idField": "address",
      "attrs": {
        "listPrefix": "$MAILGUN_LIST_PREFIX",
        "mid": "$MAILGUN_MEMBER_ID"
      },
      "resultKey": "list"
    },
    {
      "resourceId": "emailListMember",
      "resourcePath": "lists/{listPrefix}@{domain}/members/{mid}",
      "parent": "emailLists",
      "resultKey": "items"
    },
    {
      "resourceId": "emailListMembers",
      "resourcePath": "lists/{listPrefix}@{domain}/members",
      "parent": "emailLists",
      "resultKey": "list"
    },
    {
      "resourceId": "Email",
      "resourcePath": "messages",
      "authId": "account",
      "idField": "MessageID",
      "attrs": {
        "admin_email": "$ADMIN_EMAIL",
        "admin_name": "$ADMIN_NAME"
      },
      "methods": [
        "POST"
      ]
    }
  ]
}
