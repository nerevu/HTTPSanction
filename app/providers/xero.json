{
  "$schema": "../schemas/provider.schema.json",
  "prefix": "xero",
  "auths": [
    {
      "authId": "base",
      "documentationURL": "https://developer.xero.com/documentation/getting-started-guide",
      "authType": "oauth2",
      "authorizationBaseURL": "https://login.xero.com/identity/connect/authorize",
      "tokenURL": "https://identity.xero.com/connect/token",
      "refreshURL": "https://identity.xero.com/connect/token",
      "clientId": "$XERO_CLIENT_ID",
      "clientSecret": "$XERO_SECRET",
      "username": "$XERO_USERNAME",
      "password": "$XERO_PASSWORD",
      "paramMap": {
        "start": "dateAfterUtc",
        "end": "dateBeforeUtc"
      },
      "extractions": {
        "tenant_id": "result[0].tenantId"
      },
      "scope": [
        "projects",
        "offline_access",
        "accounting.transactions",
        "accounting.settings",
        "accounting.contacts",
        "accounting.attachments",
        "files",
        "assets"
      ],
      "headlessElements": [
        {
          "selector": "#xl-form-email",
          "description": "xero username",
          "content": "$XERO_USERNAME"
        },
        {
          "selector": "#xl-form-password",
          "description": "xero password",
          "content": "$XERO_PASSWORD"
        },
        {
          "selector": "#xl-form-submit",
          "description": "xero sign in",
          "action": "click"
        },
        {
          "selector": "[placeholder=\"Authentication code\"]",
          "description": "xero 2fa code",
          "prompt": "xero 2fa code"
        },
        {
          "selector": "[type=\"submit\"]",
          "description": "xero confirm",
          "action": "click"
        },
        {
          "selector": "#approveButton",
          "description": "xero connect",
          "action": "click"
        },
        {
          "selector": "#approveButton",
          "description": "xero allow access",
          "action": "click"
        },
        {
          "selector": "#approveButton",
          "description": "xero select org",
          "action": "click"
        }
      ]
    },
    {
      "authId": "simple",
      "parent": "base",
      "isDefault": true,
      "apiBaseURL": "https://api.xero.com"
    },
    {
      "authId": "api",
      "parent": "base",
      "apiBaseURL": "https://api.xero.com/api.xro/2.0",
      "headers": {
        "all": {
          "Xero-tenant-id": "{tenant_id}"
        }
      }
    },
    {
      "authId": "project",
      "parent": "base",
      "apiBaseURL": "https://api.xero.com/projects.xro/2.0",
      "headers": {
        "all": {
          "Xero-tenant-id": "{tenant_id}"
        }
      }
    }
  ],
  "statusResourceId": "connections",
  "resources": [
    {
      "resourceId": "connections",
      "authId": "simple"
    },
    {
      "resourceId": "projects",
      "authId": "project",
      "fields": [
        "projectId",
        "name",
        "status"
      ],
      "idField": "projectId",
      "resultKey": "items",
      "methods": [
        "GET",
        "POST"
      ]
    },
    {
      "resourceId": "users",
      "resourcePath": "projectsusers",
      "authId": "project",
      "fields": [
        "userId",
        "name"
      ],
      "idField": "userId",
      "resultKey": "items"
    },
    {
      "resourceId": "contacts",
      "resourcePath": "Contacts",
      "authId": "api",
      "fields": [
        "ContactID",
        "Name",
        "FirstName",
        "LastName"
      ],
      "idField": "ContactID",
      "resultKey": "Contacts"
    },
    {
      "resourceId": "payments",
      "resourcePath": "Payments",
      "authId": "api",
      "idField": "PaymentID",
      "resultKey": "Payments"
    },
    {
      "resourceId": "invoices",
      "resourcePath": "Invoices",
      "authId": "api",
      "idField": "InvoiceID",
      "resultKey": "Invoices",
      "nameField": "InvoiceNumber",
      "methods": [
        "GET",
        "POST"
      ]
    },
    {
      "resourceId": "online_invoices",
      "resourcePath": "Invoices/{iid}/OnlineInvoice",
      "authId": "api",
      "attrs": {
        "iid": ""
      },
      "idField": "OnlineInvoiceUrl",
      "resultKey": "OnlineInvoices"
    },
    {
      "resourceId": "linked_transactions",
      "resourcePath": "LinkedTransactions",
      "authId": "api",
      "idField": "LinkedTransactionID",
      "resultKey": "LinkedTransactions",
      "nameField": "LinkedTransactionID",
      "filter": {
        "field": "Status",
        "value": "VOIDED",
        "comparator": "NOT"
      }
    },
    {
      "resourceId": "inventory",
      "resourcePath": "Items",
      "authId": "api",
      "fields": [
        "ItemID",
        "Name",
        "Code",
        "Description",
        "SalesDetails"
      ],
      "idField": "ItemID",
      "resultKey": "Items",
      "nameField": "Name"
    },
    {
      "resourceId": "project_tasks",
      "resourcePath": "projects/{pid}/tasks",
      "attrs": {
        "pid": ""
      },
      "authId": "project",
      "fields": [
        "taskId",
        "name",
        "status",
        "rate.value",
        "projectId"
      ],
      "idField": "taskId",
      "resultKey": "items",
      "attrs": {
        "pid": ""
      },
      "methods": [
        "GET",
        "POST"
      ]
    },
    {
      "resourceId": "project_time",
      "resourcePath": "projects/{pid}/time",
      "authId": "project",
      "idField": "timeEntryId",
      "resultKey": "items",
      "attrs": {
        "pid": "",
        "event_pos": 0,
        "event_id": ""
      },
      "methods": [
        "GET",
        "POST"
      ]
    }
  ]
}
