{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/nerevu/HTTPSanction/features/app/schemas/auth.schema.json",
  "title": "Authentication",
  "description": "API authentication",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "documentationURL": {
      "description": "URL to API reference documentation",
      "type": "string",
      "default": "",
      "examples": [
        "https://developer.xero.com/documentation/api/accounting/overview"
      ]
    },
    "apiBaseURL": {
      "description": "Base API URL",
      "type": "string",
      "default": "",
      "examples": [
        "https://api.xero.com/api.xro/2.0",
        "https://api.xero.com/projects.xro/2.0"
      ]
    },
    "authorizationBaseURL": {
      "description": "API OAuth authorization URL",
      "type": "string",
      "default": "",
      "examples": [
        "https://login.xero.com/identity/connect/authorize"
      ]
    },
    "tokenURL": {
      "description": "API OAuth token URL",
      "type": "string",
      "default": "",
      "examples": [
        "https://identity.xero.com/connect/token"
      ]
    },
    "refreshURL": {
      "description": "API OAuth token refresh URL (defaults to the `tokenURL`)",
      "type": "string",
      "default": "",
      "examples": [
        "https://identity.xero.com/connect/token"
      ]
    },
    "revokeUrl": {
      "description": "API OAuth token revocation URL",
      "type": "string",
      "default": "",
      "examples": [
        "https://identity.xero.com/connect/token"
      ]
    },
    "redirectURI": {
      "description": "API OAuth flow callback entry point (defaults to `$PROVIDER_PREFIX-callback`",
      "type": "string",
      "default": "",
      "examples": [
        "/xero-callback"
      ]
    },
    "authId": {
      "description": "Unique identifier for the API resource",
      "type": "string",
      "pattern": "^[a-z]+(_[a-z]+)*$",
      "default": "",
      "examples": [
        "status",
        "users",
        "project_tasks"
      ]
    },
    "authType": {
      "description": "The API authentication type",
      "type": "string",
      "default": "oauth2",
      "pattern": "oauth1|oauth2|service|bearer|basic|custom"
    },
    "flowType": {
      "description": "OAuth2 flow type: web -> Authorization Grant Type, mobile -> Implicit Code Grant Type, legacy -> Password Credentials Grant Type, backend -> Client Credentials Grant Type",
      "type": "string",
      "default": "web",
      "pattern": "web|backend|legacy|mobile"
    },
    "_flowEnum": {
      "description": "OAuth2 flow enum",
      "type": "integer",
      "default": false
    },
    "_augmented": {
      "description": "The authentication has been augmented.",
      "type": "boolean",
      "default": false
    },
    "requiresBasicAuth": {
      "description": "OAuth2 flow requires basic authentication",
      "type": "boolean",
      "default": false
    },
    "clientId": {
      "description": "The API client ID",
      "type": "string",
      "default": "",
      "examples": [
        "$CLIENT_ID"
      ]
    },
    "clientSecret": {
      "description": "The API client secret",
      "type": "string",
      "default": "",
      "examples": [
        "$SECRET"
      ]
    },
    "personalAccessToken": {
      "description": "The API key or personal access token",
      "type": "string",
      "default": "",
      "examples": [
        "$ACCESS_TOKEN"
      ]
    },
    "extractions": {
      "description": "Key/Value pairs where key -> Attribute to store the extracted path in, and value -> Path to extract from the json authentication result",
      "type": "object",
      "default": {},
      "examples": [
        {
          "tenant_id": "result[0].tenantId"
        }
      ],
      "additionalProperties": {
        "type": "string"
      }
    },
    "username": {
      "description": "The application username",
      "type": "string",
      "default": "",
      "examples": [
        "$USERNAME"
      ]
    },
    "password": {
      "description": "The application password",
      "type": "string",
      "default": "",
      "examples": [
        "$PASSWORD"
      ]
    },
    "scope": {
      "description": "The API permissions scope",
      "type": "array",
      "default": [],
      "items": {
        "type": "string",
        "default": "",
        "examples": [
          "projects",
          "offline_access"
        ]
      }
    },
    "attrs": {
      "type": "object",
      "default": {},
      "$ref": "https://raw.githubusercontent.com/nerevu/HTTPSanction/features/app/schemas/attribute.schema.json"
    },
    "params": {
      "type": "object",
      "default": {},
      "$ref": "https://raw.githubusercontent.com/nerevu/HTTPSanction/features/app/schemas/attribute.schema.json"
    },
    "headless": {
      "description": "Allow headless authentication",
      "type": "boolean",
      "default": false
    },
    "debug": {
      "description": "Enable debug mode",
      "type": "boolean",
      "default": false
    },
    "apiExt": {
      "description": "Extension to place  at the end of API urls",
      "type": "string",
      "default": "",
      "examples": [
        "json"
      ]
    },
    "singularize": {
      "description": "Wrap data in a singularized resource name for POST/PATCH requests",
      "type": "boolean",
      "default": false
    },
    "dataKey": {
      "description": "Key to assign data to for POST/PATCH requests",
      "type": "string",
      "default": "json"
    },
    "resultKey": {
      "description": "The path to extract from the parsed API response (should return a list of items)",
      "type": "string",
      "examples": [
        "items"
      ]
    },
    "headers": {
      "description": "HTTP headers to include with requests (case sensitive)",
      "type": "object",
      "default": {},
      "$ref": "https://raw.githubusercontent.com/nerevu/HTTPSanction/features/app/schemas/headers.schema.json"
    },
    "methodMap": {
      "description": "Maps standard HTTP methods to API specific methods (case sensitive)",
      "type": "object",
      "default": {},
      "additionalProperties": false,
      "properties": {
        "get": {
          "description": "Map GET requests",
          "type": "string",
          "default": "GET",
          "pattern": "get|post|patch|put|delete|GET|POST|PATCH|PUT|DELETE",
          "examples": [
            "POST"
          ]
        },
        "post": {
          "description": "Map POST requests",
          "type": "string",
          "default": "POST",
          "pattern": "get|post|patch|put|delete|GET|POST|PATCH|PUT|DELETE",
          "examples": [
            "GET"
          ]
        },
        "put": {
          "description": "Map PUT requests",
          "type": "string",
          "default": "PUT",
          "pattern": "get|post|patch|put|delete|GET|POST|PATCH|PUT|DELETE",
          "examples": [
            "POST"
          ]
        },
        "patch": {
          "description": "Map PATCH requests",
          "type": "string",
          "default": "PATCH",
          "pattern": "get|post|patch|put|delete|GET|POST|PATCH|PUT|DELETE",
          "examples": [
            "POST"
          ]
        },
        "delete": {
          "description": "Map DELETE requests",
          "type": "string",
          "default": "DELETE",
          "pattern": "get|post|patch|put|delete|GET|POST|PATCH|PUT|DELETE",
          "examples": [
            "POST"
          ]
        }
      }
    },
    "paramMap": {
      "description": "Maps standard parameters to API specific parameters",
      "type": "object",
      "default": {},
      "properties": {
        "id": {
          "description": "",
          "type": "string",
          "default": "",
          "examples": [
            ""
          ]
        },
        "fields": {
          "description": "",
          "type": "string",
          "default": "",
          "examples": [
            ""
          ]
        },
        "start": {
          "description": "The start date",
          "type": "string",
          "default": "",
          "examples": [
            "dateAfterUtc"
          ]
        },
        "end": {
          "description": "The end date",
          "type": "string",
          "default": "",
          "examples": [
            "dateBeforeUtc"
          ]
        }
      }
    },
    "headlessElements": {
      "description": "Web element used to navigate a provider's application login page",
      "type": "array",
      "default": [],
      "items": {
        "$ref": "https://raw.githubusercontent.com/nerevu/HTTPSanction/features/app/schemas/headless.schema.json"
      }
    },
    "parent": {
      "description": "The base authentication object",
      "type": "string",
      "default": "",
      "examples": [
        "base"
      ]
    },
    "isDefault": {
      "description": "Use this authentication object if one isn't provided",
      "type": "boolean",
      "default": false
    },
    "example": {
      "description": "An example API request",
      "type": "string",
      "default": ""
    }
  },
  "anyOf": [
    {
      "required": [
        "authId"
      ]
    },
    {
      "required": [
        "authType"
      ]
    }
  ]
}
